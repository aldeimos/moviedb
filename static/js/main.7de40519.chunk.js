(this.webpackJsonpmoviedb=this.webpackJsonpmoviedb||[]).push([[0],{29:function(e,t,a){e.exports=a.p+"static/media/logo.56fd61ee.svg"},30:function(e,t,a){e.exports=a.p+"static/media/male.21a1bdaa.svg"},31:function(e,t,a){e.exports=a.p+"static/media/favorite_off.05e37c73.svg"},32:function(e,t,a){e.exports=a.p+"static/media/favorite_on.1f43ea1c.svg"},33:function(e,t,a){e.exports=a(68)},39:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return Y}));var r=a(0),n=a.n(r),c=a(17),l=a.n(c),i=a(13),o=a(7),s=a(4),m={popular_films:[],favorites_films:JSON.parse(localStorage.getItem("favorites_films")||"[]"),genres:[],film_details:{},filterMode:"popular",sortMode:"default",searchValue:""},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_popular":var a=t.popular_films;return Object(s.a)(Object(s.a)({},e),{},{popular_films:a});case"load_more_popular":var r=t.films;return Object(s.a)(Object(s.a)({},e),{},{popular_films:[].concat(Object(o.a)(e.popular_films),Object(o.a)(r))});case"load_genres":var n=t.genres;return Object(s.a)(Object(s.a)({},e),{},{genres:n});case"load_film_details":var c=t.film_details;return Object(s.a)(Object(s.a)({},e),{},{film_details:c});case"add_to_favorites":var l=t.film,i=[].concat(Object(o.a)(e.favorites_films),[l]);return localStorage.setItem("favorites_films",JSON.stringify(i)),Object(s.a)(Object(s.a)({},e),{},{favorites_films:i});case"delete_from_favorites":var u=t.filmId,f=e.favorites_films.filter((function(e){return e.id!==u}));return localStorage.setItem("favorites_films",JSON.stringify(f)),Object(s.a)(Object(s.a)({},e),{},{favorites_films:f});case"set_filter_mode":var d=t.filterMode;return Object(s.a)(Object(s.a)({},e),{},{filterMode:d});case"set_sort_mode":var _=t.sortMode;return Object(s.a)(Object(s.a)({},e),{},{sortMode:_});case"set_search_value":var v=t.searchValue;return Object(s.a)(Object(s.a)({},e),{},{searchValue:v});default:return e}},f=Object(i.b)({films:u}),d=a(10),_=a(14),v=a(3),p=(a(39),a(29)),g=a.n(p),h=a(30),b=a.n(h),E=function(){return n.a.createElement("header",{className:"header"},n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"header__wrapper"},n.a.createElement("div",{className:"header__logo"},n.a.createElement(_.b,{to:"/"},n.a.createElement("img",{src:g.a,alt:"Logo",width:154,height:20}))),n.a.createElement("div",{className:"header__profile"},n.a.createElement("img",{src:b.a,alt:"User Avatar"}),"Nickname"))))},j=a(1),O=function(e){return{type:"set_sort_mode",sortMode:e}},w=a(12),N=a.n(w),y=a(20),S="52f110ad1b13b1b6c28850d706a5eb73",M="https://api.themoviedb.org/3/",k=function(){var e=Object(y.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://api.themoviedb.org/3/movie/".concat(t,"?api_key=").concat(S)).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(y.a)(N.a.mark((function e(){var t,a=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:1,e.abrupt("return",fetch("".concat(M,"movie/popular?api_key=").concat(S,"&page=").concat(t)).then((function(e){return e.json()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(M,"genre/movie/list?api_key=").concat(S)).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=(a(54),function(e){var t=e.title,a=e.handler,r=e.active;return n.a.createElement("div",{className:"filter-item ".concat(r&&"filter-item_active"),onClick:a},t)}),x=(a(55),function(){var e=Object(j.b)(),t=Object(j.c)((function(e){return e.films.filterMode})),a=function(t){e(function(e){return{type:"set_filter_mode",filterMode:e}}(t)),e(O("default"))};return n.a.createElement("section",{className:"filter"},n.a.createElement(F,{title:"Popular",handler:function(){return a("popular")},active:"popular"===t}),n.a.createElement(F,{title:"Favorites",handler:function(){return a("favorites")},active:"favorites"===t}))}),I=(a(56),function(){var e=Object(j.b)(),t=Object(j.c)((function(e){return e.films.searchValue}));return n.a.createElement("section",{className:"search"},n.a.createElement("label",{className:"search__label",htmlFor:"search"},"Search films"),n.a.createElement("input",{className:"search__input",id:"search",type:"text",name:"search",placeholder:"Search whatever you want",value:t,onChange:function(t){return e(function(e){return{type:"set_search_value",searchValue:e}}(t.target.value))}}))}),V=(a(57),function(e){var t=e.title,a=e.handler,r=e.active;return n.a.createElement("div",{className:"sort-item ".concat(r&&"sort-item_active"),onClick:a},t)}),J=(a(58),function(){var e=Object(j.b)(),t=Object(j.c)((function(e){return e.films.sortMode})),a=function(t){e(O(t))};return n.a.createElement("section",{className:"sort"},n.a.createElement(V,{title:"Sort by default",handler:function(){return a("default")},active:"default"===t}),n.a.createElement(V,{title:"Sort by date",handler:function(){return a("release_date")},active:"release_date"===t}),n.a.createElement(V,{title:"Sort by rating",handler:function(){return a("vote_average")},active:"vote_average"===t}))}),R=a(11),$=a.n(R),U=(a(60),a(31)),B=a.n(U),D=a(32),P=a.n(D),X=function(e){var t=e.id,a=e.title,c=e.release_date,l=e.poster_path,i=e.vote_average,s=e.genres,m=e.genreIds,u=e.overview,f=JSON.parse(localStorage.getItem("favorites_films")||"[]"),v=Object(j.b)(),p=Object(r.useState)(0!==f.filter((function(e){return e.id===t})).length),g=Object(d.a)(p,2),h=g[0],b=g[1],E=Object(r.useState)([]),O=Object(d.a)(E,2),w=O[0],N=O[1];return Object(r.useEffect)((function(){m.forEach((function(e){s.forEach((function(t){t.id===e&&N((function(e){return[].concat(Object(o.a)(e),[t.name])}))}))}))}),[s]),n.a.createElement("div",{className:"film-card"},n.a.createElement(_.b,{to:"/details/".concat(t)},n.a.createElement("div",{className:"film-card__poster"},n.a.createElement("img",{src:"https://image.tmdb.org/t/p/w300_and_h450_bestv2/".concat(l),alt:"Film's Poster"}),n.a.createElement("div",{className:"film-card__to-fav",onClick:function(e){if(e.preventDefault(),h)return v({type:"delete_from_favorites",filmId:t}),b(!1),void window.M.toast({html:"\u0424\u0438\u043b\u044c\u043c \u0443\u0434\u0430\u043b\u0435\u043d \u0438\u0437 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e"});v({type:"add_to_favorites",film:{id:t,title:a,release_date:c,poster_path:l,vote_average:i,genres:s,genre_ids:m,overview:u}}),b(!0),window.M.toast({html:"\u0424\u0438\u043b\u044c\u043c \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"})}},n.a.createElement("img",{src:h?P.a:B.a,alt:"Favorite",width:48,height:48}))),n.a.createElement("div",{className:"film-card__title"},n.a.createElement("h3",null,a," |"),n.a.createElement("span",{className:"film-card__rating ".concat(i>=7?"film-card__rating_high":i<7&&i>4?"film-card__rating_medium":"film-card__rating_low")},i)),n.a.createElement("div",{className:"film-card__info"},n.a.createElement("div",{className:"film-card__release-date"},$()(c).format("LL")),n.a.createElement("div",{className:"film-card__genres"},w.slice(0,w.length<=3?w.length:3).join(", "))),n.a.createElement("div",{className:"film-card__desc"},u.slice(0,200),"...")))},A=(a(61),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";switch(t){case"release_date":var a=Object(o.a)(e);return a.sort((function(e,t){return $()(e.release_date).format("X")-$()(t.release_date).format("X")}));case"vote_average":var r=Object(o.a)(e);return r.sort((function(e,t){return e.vote_average-t.vote_average}));default:return e}}),G=function(e){var t=e.genres,a=e.favoritesFilms,r=e.sortMode,c=e.searchValue,l=Object(j.c)((function(e){return e.films.popular_films})),i=A(l,r);return n.a.createElement(n.a.Fragment,null,0!==i.filter((function(e){return e.title.toLowerCase().includes(c.toLowerCase())})).length?i.filter((function(e){return e.title.toLowerCase().includes(c.toLowerCase())})).map((function(e){return n.a.createElement(X,{key:e.id,id:e.id,vote_average:e.vote_average,release_date:e.release_date,overview:e.overview,poster_path:e.poster_path,title:e.title,runtime:e.runtime,genreIds:e.genre_ids,genres:t,favoritesFilms:a})})):n.a.createElement("div",null,"Unfortunately we did not find anything :("))},q=function(e){var t=e.genres,a=e.favoritesFilms,r=e.sortMode,c=e.searchValue,l=A(a,r);return n.a.createElement(n.a.Fragment,null,0!==l.filter((function(e){return e.title.toLowerCase().includes(c.toLowerCase())})).length?l.filter((function(e){return e.title.toLowerCase().includes(c.toLowerCase())})).map((function(e){return n.a.createElement(X,{key:e.id,id:e.id,vote_average:e.vote_average,release_date:e.release_date,overview:e.overview,poster_path:e.poster_path,title:e.title,runtime:e.runtime,genreIds:e.genre_ids,genres:t,favoritesFilms:a})})):n.a.createElement("div",null,"Unfortunately we did not find anything :("))},z=(a(62),function(){return n.a.createElement("div",{className:"lds-ring"},n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null))}),H=(a(63),function(e){var t=e.loading,a=e.setLoading,c=Object(r.useState)(1),l=Object(d.a)(c,2),i=l[0],o=l[1],s=Object(j.b)(),m=JSON.parse(localStorage.getItem("favorites_films")),u=Object(j.c)((function(e){return e.films.filterMode})),f=Object(j.c)((function(e){return e.films.sortMode})),_=Object(j.c)((function(e){return e.films.searchValue})),v=Object(j.c)((function(e){return e.films.genres}));return console.log(t),n.a.createElement("div",{className:"welcome"},n.a.createElement("div",{className:"welcome__controls"},n.a.createElement("div",{className:"welcome__controls-row welcome__controls-row_1"},n.a.createElement(x,null)),n.a.createElement("div",{className:"welcome__controls-row welcome__controls-row_2"},n.a.createElement(I,null))),n.a.createElement("div",{className:"welcome__sort"},n.a.createElement(J,null)),n.a.createElement("div",{className:"welcome__content"},t?n.a.createElement(z,null):"popular"===u?n.a.createElement(G,{favoritesFilms:m,sortMode:f,searchValue:_,genres:v}):n.a.createElement(q,{favoritesFilms:m,sortMode:f,searchValue:_,genres:v})),"popular"===u&&!t&&n.a.createElement("button",{className:"welcome__show-more",type:"button",onClick:function(){return o(e=i+1),a(!0),void L(e).then((function(e){a(!1),s({type:"load_more_popular",films:e.results})}));var e}},"Show more"))}),K=(a(64),function(e){var t=e.poster,a=e.title,r=e.vote_average;return n.a.createElement("div",{className:"recommended-film"},n.a.createElement("div",{className:"recommended-film__poster"},n.a.createElement("img",{src:t,alt:""})),n.a.createElement("div",{className:"recommended-film__title"},a),n.a.createElement("div",{className:"recommended-film__rating"},r))}),Q=(a(65),function(e){return e.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")}),T=function(e){var t=e.match,a=Object(j.b)(),c=Object(r.useState)([]),l=Object(d.a)(c,2),i=(l[0],l[1],Object(j.c)((function(e){return e.films.film_details}))),s=Object(j.c)((function(e){return e.films.popular_films})),m=i.id,u=i.title,f=i.tagline,_=i.runtime,v=i.budget,p=i.genres,g=i.revenue,h=i.release_date,b=i.vote_average,E=i.poster_path,O=i.overview;console.log(i),Object(r.useEffect)((function(){k(t.params.id).then((function(e){return a({type:"load_film_details",film_details:e})}))}),[]);return n.a.createElement("div",{className:"film-details"},n.a.createElement("div",{className:"film-details__poster"},n.a.createElement("img",{src:"https://image.tmdb.org/t/p/w600_and_h900_bestv2".concat(E),alt:""})),n.a.createElement("div",{className:"film-details__content"},n.a.createElement("h3",{className:"film-details__title"},u),n.a.createElement("p",{className:"film-details__tagline"},f),n.a.createElement("p",{className:"film-details__paragraph film-details__runtime"},"Runtime: ",function(e){var t=Math.trunc(e/60),a=e%60;return"".concat(t,"h ").concat(a,"m")}(_)),n.a.createElement("p",{className:"film-details__paragraph film-details__release-date"},"Release date: ",function(e){return $()(e).format("LL")}(h)),n.a.createElement("p",{className:"film-details__paragraph film-details__budget"},"Budget: $ ",Q(String(v))),n.a.createElement("p",{className:"film-details__paragraph film-details__revenue"},"Revenue: $ ",Q(String(g))),n.a.createElement("p",{className:"film-details__paragraph film-details__rating"},"Rating: ",b),n.a.createElement("p",{className:"film-details__paragraph film-details__genres"},"Genres: ",p&&p.map((function(e){return e.name})).join(", "))),n.a.createElement("div",{className:"film-details__overview"},n.a.createElement("h3",null,"Description:"),O),n.a.createElement("div",{className:"film-details__recommended-films"},n.a.createElement("h3",null,"Recommended films:"),i.genres&&s.filter((function(e){if(e.id!==m)return e.genre_ids.includes(function(e){for(var t,a=Object(o.a)(e),r=a.length-1;r>0;r--){t=Math.floor(Math.random()*(r+1));var n=[a[r],a[t]];a[t]=n[0],a[r]=n[1]}return a}(p)[0].id)})).map((function(e){return n.a.createElement(K,e)}))))},W=(a(66),a(67),function(){var e=Object(j.b)(),t=Object(r.useState)(!1),a=Object(d.a)(t,2),c=a[0],l=a[1];return Object(r.useEffect)((function(){l(!0),L(1).then((function(t){l(!1),e(function(e){return{type:"load_popular",popular_films:e}}(t.results))}))}),[]),Object(r.useEffect)((function(){C().then((function(t){return e(function(e){return{type:"load_genres",genres:e}}(t.genres))}))}),[]),n.a.createElement(_.a,{basename:"/moviedb"},n.a.createElement(E,null),n.a.createElement("div",{className:"container"},n.a.createElement(v.d,null,n.a.createElement(v.b,{path:"/",exact:!0},n.a.createElement(H,{loading:c,setLoading:l})),n.a.createElement(v.b,{path:"/details/:id",exact:!0,component:T}),n.a.createElement(v.a,{from:"/details",to:"/"}))))}),Y=Object(i.c)(f);l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(j.a,{store:Y},n.a.createElement(W,null))),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.7de40519.chunk.js.map